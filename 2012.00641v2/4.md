# IV. PHÂN LOẠI THEO MỨC ĐỘ GIÁM SÁT KHÁC NHAU

Phần này bao gồm các phương pháp truy xuất ảnh dựa trên các **loại hình giám sát (supervision types)** khác nhau. Về cơ bản, các phương pháp tiếp cận **có giám sát (supervised)**, **không giám sát (unsupervised)**, **bán giám sát (semi-supervised)**, **giám sát yếu (weakly-supervised)**, **giả giám sát (pseudo-supervised)** và **tự giám sát (self-supervised)** đều được đề cập.

## A. Các Phương pháp Có giám sát (Supervised)

Các mô hình học sâu có giám sát được các nhà nghiên cứu sử dụng rất nhiều để học các đặc trưng **đặc trưng cho lớp (class-specific)** và có **tính phân biệt (discriminative)** cho truy xuất ảnh.

*   Năm 2014, Xia et al. đã sử dụng một CNN để học biểu diễn của hình ảnh, biểu diễn này sau đó được dùng để tạo ra **mã băm (hash code)** và **nhãn lớp (class labels)** [95]. Hiệu năng đầy hứa hẹn được báo cáo trên các tập dữ liệu MNIST, CIFAR-10 và NUS-WIDE.
*   Shen et al. (2015) [96] đã đề xuất việc tạo mô tả ảnh dựa trên **băm rời rạc có giám sát (supervised discrete hashing - SDH)** với sự trợ giúp của **phép hạ tọa độ tuần hoàn rời rạc (discrete cyclic coordinate descent)** để truy xuất.
*   Liu et al. (2016) đã thực hiện một công trình mang tính đột phá bằng cách giới thiệu phương pháp **băm sâu có giám sát (deep supervised hashing - DSH)** để học mã nhị phân từ các **cặp hình ảnh tương tự/không tương tự (similar/dissimilar pairs)** [97].
*   Một công trình tương tự cũng được trình bày trong phương pháp **băm có giám sát theo cặp sâu (deep pairwise-supervised hashing - DPSH)** để truy xuất ảnh [98].
*   Các nhãn theo cặp được mở rộng thành **nhãn bộ ba (triplet labels)** (ảnh truy vấn, ảnh tích cực và ảnh tiêu cực) để huấn luyện một mô hình CNN sâu được chia sẻ cho việc học đặc trưng [99].
*   Các **cập nhật cục bộ theo từng lớp độc lập (independent layer-wise local updates)** được thực hiện trong [100] để huấn luyện hiệu quả một mô hình **băm sâu có giám sát rất sâu (very deep supervised hashing - VDSH)**.

*   Năm 2017, Li et al. đã sử dụng thông tin phân loại và thông tin nhãn theo cặp trong một **framework duy nhất** để học các mã **băm rời rạc sâu có giám sát (deep supervised discrete hashing - DSDH)** [101].
*   Mô hình **băm sâu bảo toàn ngữ nghĩa có giám sát (supervised semantics-preserving deep hashing - SSDH)** tích hợp các đặc điểm truy xuất và phân loại trong việc học đặc trưng [102].
*   Việc tìm kiếm ảnh có thể **mở rộng (scalable)** được thực hiện trong [103] bằng cách giới thiệu ba đặc điểm sau:
    1.  Tối thiểu hóa mất mát giữa mã giá trị thực (real-valued code) và mã nhị phân đã chuyển đổi tương đương.
    2.  Đảm bảo phân phối đều (even distribution) giữa mỗi bit trong mã nhị phân.
    3.  Giảm sự dư thừa (redundancy) của một bit trong mã nhị phân.

*   Việc huấn luyện có giám sát cũng được lựa chọn trong **băm bất đối xứng (asymmetric hashing)** [104].
*   Một mô hình **lượng tử hóa tích sâu (deep product quantization - DPQ)** được áp dụng theo chế độ học có giám sát để tìm kiếm và truy xuất ảnh [105].
*   **Phép nhúng đặc trưng sâu có giám sát (supervised deep feature embedding)** cũng được sử dụng kết hợp với các đặc trưng thủ công [106].
*   Rất gần đây, **băm đa cấp (multi-Level hashing)** các đặc trưng sâu được thực hiện bởi Ng et al. (2020) [107].
*   Một **hàm mất mát băm góc (angular hashing loss function)** được sử dụng để huấn luyện mạng theo cách có giám sát [108].
*   Băm có giám sát cũng được sử dụng cho **xếp hạng đa sâu (multi-deep ranking)** [109] để cải thiện hiệu quả truy xuất.
*   Các phương pháp có giám sát khác bao gồm: mã băm nhị phân sâu (deep binary hash codes) [51], mạng băm sâu (deep hashing network) [67], lượng tử hóa cầu sâu (deep spherical quantization) [81] và học sâu có giám sát dựa trên mất mát thích ứng để băm (adaptive loss based supervised deep learning to hash) [84].

## B. Các Phương pháp Không giám sát (Unsupervised)

Mặc dù các mô hình có giám sát đã cho thấy hiệu năng đầy hứa hẹn cho truy xuất, nhưng việc luôn có được dữ liệu quy mô lớn được gắn nhãn là rất khó khăn. Do đó, một số mô hình **không giám sát** cũng đã được nghiên cứu, những mô hình này **không yêu cầu nhãn lớp**. Các mô hình không giám sát thường áp đặt các **ràng buộc (constraints)** lên mã băm và/hoặc đầu ra được tạo ra để học các đặc trưng.

*   Erin et al. (2015) [110] đã sử dụng các mạng sâu theo cách không giám sát để học mã băm với sự trợ giúp của các ràng buộc như **mất mát lượng tử hóa (quantization loss)**, **bit cân bằng (balanced bits)** và **bit độc lập (independent bits)**.
*   Huang et al. (2016) [111] đã sử dụng CNN kết hợp với **phân cụm phân biệt không giám sát (unsupervised discriminative clustering)**.
*   Trong một công trình xuất sắc, **DeepBit** sử dụng các ràng buộc như mất mát lượng tử hóa tối thiểu, mã được phân phối đều và các bit không tương quan để truy xuất ảnh không giám sát [112], [113]. Để cải thiện tính mạnh mẽ của DeepBit, một quá trình **tinh chỉnh (fine tuning)** dựa trên **tăng cường dữ liệu xoay (rotation data augmentation)** cũng được thực hiện. Tuy nhiên, mô hình DeepBit gặp phải mất mát lượng tử hóa nghiêm trọng do việc **nhị phân hóa (binarization)** dữ liệu một cách cứng nhắc bằng hàm sign mà không xem xét thuộc tính phân phối của nó.
*   **Bộ mô tả nhị phân sâu với đa lượng tử hóa (Deep binary descriptor with multiquantization - DBD-MQ)** [114] giải quyết vấn đề lượng tử hóa của DeepBit bằng cách đồng thời học các tham số và các hàm nhị phân hóa sử dụng **K-Mã tự động (K-AutoEncoders - KAEs)**.

*   Người ta quan sát thấy trong [115] rằng CNN không giám sát có thể học các đặc trưng phân biệt hơn nếu được tinh chỉnh với các **ví dụ tích cực khó (hard positive)** và **ví dụ tiêu cực khó (hard negative)**.
*   Biểu diễn **mảnh (patch)** sử dụng **mạng kernel tích chập mảnh (patch convolutional kernel network)** cũng được điều chỉnh để truy xuất mảnh [116].
*   Một **bộ ba (triplet)** dựa trên ảnh neo (anchor), ảnh bị xoay và ảnh ngẫu nhiên được sử dụng trong **băm bộ ba không giám sát (unsupervised triplet hashing - UTH)** để học mã nhị phân cho truy xuất ảnh [117]. Hàm mục tiêu UTH sử dụng sự kết hợp của mất mát phân biệt (discriminative loss), mất mát lượng tử hóa và mất mát entropy.
*   Một phương pháp **băm sâu thích ứng tương tự không giám sát (unsupervised similarity-adaptive deep hashing - SADH)** được đề xuất trong [118] bằng cách cập nhật **đồ thị tương tự (similarity graph)** và tối ưu hóa các mã nhị phân.
*   Xu et al. (2018) [119] đã đề xuất một phương pháp **tổng hợp có trọng số theo phần nhận biết ngữ nghĩa (semantic-aware part weighted aggregation)** sử dụng các bộ phát hiện dựa trên phần (part-based detectors) cho các hệ thống CBIR.
*   **Mạng đối sinh (Generative adversarial networks - GANs)** không giám sát [120], [121], [122] cũng được nghiên cứu cho truy xuất ảnh.
*   Các **cặp dữ liệu chưng cất (distill data pairs)** [82] và **mạng biến phân sâu (deep variational networks)** [86] cũng được sử dụng cho truy xuất ảnh không giám sát.
*   Kỹ thuật **băm bộ ba sâu không giám sát (unsupervised deep triplet hashing - UDTH)** dựa trên **bộ ba giả (pseudo triplets)** [123] được giới thiệu cho truy xuất ảnh có thể mở rộng.
*   Rất gần đây, **học chuyển tiếp sâu không giám sát (unsupervised deep transfer learning)** đã được khai thác bởi Liu et al. (2020) [124] để truy xuất trong các ảnh viễn thám.

**Tóm tắt:** Mặc dù các mô hình không giám sát không cần dữ liệu có nhãn, hiệu suất của nó thường thấp hơn so với các phương pháp có giám sát. Do đó, các nhà nghiên cứu đã khám phá các mô hình nằm giữa có giám sát và không giám sát, chẳng hạn như bán giám sát, giám sát yếu, giả giám sát và tự giám sát.
## C. Các phương pháp tiếp cận bán giám sát, yếu, giả và tự giám sát
Các phương pháp tiếp cận bán giám sát thường sử dụng kết hợp dữ liệu có nhãn và không có nhãn để học đặc trưng
[168], [169]. Băm sâu bán giám sát (SSDH) [141]
sử dụng dữ liệu có nhãn để giảm thiểu lỗi thực nghiệm và
sử dụng cả dữ liệu có nhãn và không có nhãn để giảm thiểu lỗi nhúng. Học đối kháng sinh sinh cũng đã được sử dụng rộng rãi trong truy xuất ảnh bán giám sát [147],
[161], [170]. Truy xuất ảnh bán giám sát dựa trên giáo viên-học sinh [171] sử dụng thông tin từng cặp được học bởi mạng giáo viên làm hướng dẫn để huấn luyện mạng học sinh.
Các phương pháp tiếp cận có giám sát yếu cũng đã được khám phá cho việc truy xuất ảnh. Tang và cộng sự (2017) đã đề xuất một phương pháp băm đa phương thức giám sát yếu (WMH) bằng cách sử dụng các cấu trúc phân biệt cục bộ và hình học trong không gian thị giác [172]. Guan và cộng sự (2018) [173] đã thực hiện quá trình huấn luyện trước ở chế độ giám sát yếu và tinh chỉnh ở chế độ giám sát. Một phương pháp băm sâu giám sát yếu sử dụng nhúng thẻ (WDHT) [174] sử dụng nhúng ngữ nghĩa word2vec. Một phương pháp băm hướng dẫn ngữ nghĩa (SGH) [175] được sử dụng để truy xuất hình ảnh bằng cách sử dụng đồng thời thông tin thẻ giám sát yếu và các mối quan hệ dữ liệu vốn có.
Các mạng giả giám sát cũng đã được phát triển
cho việc truy xuất hình ảnh. Các bộ ba giả được sử dụng trong [123]
cho việc truy xuất hình ảnh không giám sát. Các nhãn giả dựa trên phân cụm K-means
được tạo ra và sử dụng để huấn luyện mạng băm sâu [176], [177]. Một hiệu suất hấp dẫn đã được quan sát thấy khi sử dụng nhãn giả trên các tập dữ liệu CIFAR-10 và Flickr
cho việc truy xuất hình ảnh.
Tự giám sát là một phương pháp giám sát khác được sử dụng
trong một số công trình nghiên cứu về truy xuất hình ảnh. Ví dụ,
Li và cộng sự (2018) [146] đã sử dụng các mạng đối nghịch ở
chế độ tự giám sát bằng cách sử dụng các chú thích đa nhãn.
Zhang và cộng sự (2016) [178] đã giới thiệu một phương pháp băm thời gian tự giám sát (SSTH) cho việc truy xuất video.
## D. Tóm tắt
Sau đây là những điểm chính rút ra từ cuộc thảo luận trên về
các mô hình học sâu dựa trên góc nhìn giám sát:

Hình 5: Sơ đồ trình tự thời gian của các phương pháp truy xuất hình ảnh dựa trên học sâu, mô tả các loại mạng nơ-ron khác nhau được sử dụng từ năm 2011 đến năm 2020. Các phương pháp học sâu dựa trên mạng nơ-ron tích chập, mạng tự động mã hóa, mạng siamese & triplet, mạng nơ-ron hồi quy, mạng đối kháng sinh sinh, mạng chú ý và mạng học tăng cường để truy xuất hình ảnh được mô tả lần lượt bằng các màu Đỏ, Lục lam, Hồng cánh sen, Đen, Xanh lam, Xanh lục và Vàng.
![fig2](image/a2.png)

• Các phương pháp tiếp cận có giám sát sử dụng thông tin ngữ nghĩa cụ thể của từng lớp thông qua lỗi phân loại, ngoài các mục tiêu khác liên quan đến việc tạo mã băm. Nhìn chung, hiệu suất của các mô hình có giám sát
tốt hơn các mô hình khác do học được thông tin chi tiết và cụ thể của từng lớp.
• Các mô hình không giám sát sử dụng các ràng buộc không giám sát
trên mã băm (ví dụ: mất mát lượng tử hóa, bit độc lập, v.v.) và/hoặc tái tạo dữ liệu (ví dụ: sử dụng
một loại mạng tự động mã hóa) để học các đặc điểm.
• Các phương pháp bán giám sát khai thác dữ liệu có nhãn và không có nhãn để học thuộc tính bằng cách sử dụng mạng sâu. Các phương pháp này thường sử dụng thông tin từ các phương thức khác nhau sử dụng các mạng khác nhau.
• Các phương pháp giả giám sát tạo ra các nhãn giả bằng một số phương pháp khác để hỗ trợ việc huấn luyện bằng các nhãn đã tạo. Các phương pháp tự giám sát tạo ra thông tin tạm thời hoặc thông tin sinh ra để học các mô hình trong các khoảng thời gian huấn luyện.
• Lỗi lượng tử hóa tối thiểu, các bit độc lập, thuộc tính chiều thấp và mã phân biệt là các mục tiêu chung của hầu hết các phương pháp truy xuất.