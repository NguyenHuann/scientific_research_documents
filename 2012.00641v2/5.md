# V. CÁC LOẠI MẠNG CHO TRUY XUẤT ẢNH

Phần này trình bày các phương pháp tiếp cận truy xuất ảnh dựa trên học sâu dưới góc độ của các **kiến trúc (architectures)** khác nhau. Một tổng quan theo trình tự thời gian từ 2011 đến 2020 được minh họa trong Hình 5 cho các loại mạng khác nhau dùng cho truy xuất ảnh.

## A. Mạng Neural Tích chập (CNN) cho Truy xuất Ảnh

Việc học đặc trưng dựa trên **Mạng Neural Tích chập (Convolutional Neural Networks - CNN)** đã được sử dụng rộng rãi cho truy xuất ảnh, như được minh họa trong Hình 4.

*   Năm 2014, các đặc trưng CNN **dùng ngay (off-the-shelf)** đã cho thấy một **bước tiến hiệu năng đáng kể (tremendous performance gain)** cho nhận dạng và truy xuất ảnh so với các đặc trưng thủ công [32].
*   Cùng thời điểm, các **kích hoạt (activations)** của CNN đã được huấn luyện cũng được khám phá như là **mã neural (neural code)** để truy xuất [61].
*   Việc học biểu diễn hình ảnh cũng đã được thực hiện bằng cách sử dụng mô hình CNN để tạo ra **bộ mô tả (descriptor)** cho truy xuất ảnh [95].
![Hình 6: Một mạng Autoencoder điển hình bao gồm mạng Mã hóa (Encoder) và mạng Giải mã (Decoder). Thông thường, bộ mã hóa là một CNN và bộ giải mã là một up-CNN. Đầu ra của bộ mã hóa là một không gian tiềm ẩn (latent space) được sử dụng để tạo ra các mã băm.](image/a5.png)
*Hình 6: Một mạng Autoencoder điển hình bao gồm mạng Mã hóa (Encoder) và mạng Giải mã (Decoder). Thông thường, bộ mã hóa là một CNN và bộ giải mã là một up-CNN (CNN ngược để tăng kích thước). Đầu ra của bộ mã hóa là một không gian tiềm ẩn (latent vector/space) được sử dụng để tạo ra các mã băm.*
*   Năm 2016, các **nhãn theo cặp (pairwise labels)** được khai thác để học đặc trưng CNN cho truy xuất ảnh [97], [98].
*   Các kích hoạt CNN được sử dụng rất nhiều để tạo ra **mã băm (hash codes)** cho truy xuất ảnh hiệu quả bằng cách sử dụng các **hàm mất mát (losses)** khác nhau [65], [68], [71].
*   Các đặc trưng trừu tượng của CNN được học cho truy xuất ảnh trong các chế độ khác nhau, chẳng hạn như:
    *   Truy xuất ảnh **không giám sát** [112], [114], [118], [113]
    *   Truy xuất ảnh **có giám sát** [95], [97], [103], [106]
    *   Truy xuất ảnh **bán giám sát** [141]
    *   Truy xuất **đa phương thức (cross-modal)** [134], [142]
    *   Truy xuất ảnh dựa trên **phác thảo (sketch)** [151], [158]
    *   Truy xuất **đối tượng (object)** [126], [165]

## B. Truy xuất Ảnh dựa trên Mạng Mã tự động (Autoencoder)

**Mã tự động (Autoencoder - AE)** là một loại mạng neural **không giám sát** có thể được sử dụng để **tái tạo (reconstruct)** hình ảnh đầu vào từ **không gian tiềm ẩn (latent space)**, như được mô tả trong Hình 6. Về cơ bản, nó bao gồm hai mạng, được gọi là **mã hóa (encoder - En)** và **giải mã (decoder - De)**.

*   Mạng mã hóa biến đổi đầu vào (I) thành không gian đặc trưng tiềm ẩn (z): `En : I → z`.
*   Trong khi đó, mạng giải mã cố gắng tái tạo hình ảnh gốc (I') từ không gian tiềm ẩn: `De : z → I'`.
*   Mục tiêu là làm cho đầu ra được tái tạo (I') **càng gần càng tốt** với đầu vào ban đầu (I).



*Hình 7: (a) Mạng Siamese tính toán độ tương tự giữa các cặp ảnh. (b) Mạng Triplet cực tiểu hóa khoảng cách giữa điểm neo (anchor) và điểm tích cực (positive) và đồng thời cực đại hóa khoảng cách giữa điểm neo và điểm tiêu cực (negative) trong không gian đặc trưng.*

không gian đặc trưng dưới dạng `De : z → I'`. Mô hình được huấn luyện bằng cách cực tiểu hóa **lỗi tái tạo (reconstruction error)** giữa ảnh gốc (I) và ảnh được tái tạo (I') sử dụng hàm mất mát L1 hoặc L2.

Các mạng mã tự động (autoencoders) đã được sử dụng rất **chuyên sâu (intensively)** để học các đặc trưng trong không gian tiềm ẩn cho truy xuất ảnh.

*   Trong những nỗ lực ban đầu, **mã tự động sâu (deep autoencoder)** đã được sử dụng cho truy xuất ảnh vào năm 2011 [58].
*   Một **mã tự động khử nhiễu xếp chồng (stacked denoising autoencoder)** được sử dụng để huấn luyện **nhiều mạng neural sâu (multiple deep neural networks)** cho nhiệm vụ truy xuất [60].
*   Feng et al. (2014) đã sử dụng **mã tự động tương ứng (correspondence autoencoder - CorrAE)** cho truy xuất đa phương thức (cross-modal) [125].
*   Một **mã tự động nhị phân (binary autoencoder)** được sử dụng để học mã nhị phân cho truy xuất ảnh nhanh bằng cách tái tạo hình ảnh từ hàm mã nhị phân đó [127].
*   Việc sử dụng mã tự động trong truy xuất ảnh đã chứng kiến sự **tiến bộ to lớn (huge progress)** trong những năm gần đây, chẳng hạn như:
    *   **Binaries biến phân sâu (Deep variational binaries - DVB)** sử dụng mạng Bayesian biến phân (variational Bayesian networks) [86];
    *   Mã tự động trên **bộ ba (triplet)** [123];
    *   Và **Mã tự động nhị phân thư giãn (Relaxed binary autoencoder - RBA)** [152] được nghiên cứu vào năm 2019.
*   Trong một công trình gần đây, **nút thắt cổ chai kép (double latent bottlenecks)** được sử dụng trong mã tự động [87]. Nó bao gồm **biến tiềm ẩn nhị phân (binary latent variable)** và **biến tiềm ẩn liên tục (continuous latent variable)**. Nút thắt biến tiềm ẩn trao đổi thông tin quan trọng một cách hợp tác và nút thắt mã nhị phân sử dụng một **đồ thị được điều khiển bởi mã (code-driven graph)** để nắm bắt **cấu trúc dữ liệu nội tại (intrinsic data structure)**.

## C. Mạng Siamese và Mạng Triplet cho Truy xuất Ảnh

### 1) Mạng Siamese:
Mạng **Siamese** là một loại mạng neural khai thác **khoảng cách (distance)** giữa các đặc trưng của các cặp ảnh, như được mô tả trong Hình 7(a). Các đặc trưng được học bởi mạng Siamese đã cho thấy hiệu năng rất hứa hẹn cho truy xuất ảnh **chi tiết (fine-grained)** [62].

*   Một cặp hình ảnh tương tự hoặc không tương tự được xử lý chung bởi Liu et al. [97] để tạo ra đầu ra 1 hoặc -1 bởi CNN nhằm học đặc trưng cho truy xuất ảnh.
*   Ong et al. (2017) đã sử dụng **vector Fisher (fisher vector)** được tính trên đầu của đặc trưng CNN trong mạng mã tự động để tạo ra bộ mô tả đặc trưng có tính phân biệt cho truy xuất ảnh [136].
*   Mạng Siamese cũng được sử dụng để phát triển các **mô hình nhẹ (light weight models)** cho truy xuất ảnh hiệu quả [144], [124].
*   Một **mất mát lượng tử hóa bảo toàn độ tương tự theo cặp (pairwise similarity-preserving quantization loss)** được sử dụng trong [162].
*   Mạng Siamese được sử dụng với **mạng đối kháng xếp chồng (stacked adversarial network)** trong [163].
*   Mạng Siamese cũng được sử dụng cho **so khớp ảnh dựa trên mảnh (patch based image matching)** [128], [129].

### 2) Mạng Triplet:
Mạng **Triplet** là một biến thể của mạng Siamese, nó sử dụng một **bộ ba (triplet)** hình ảnh, bao gồm một ảnh **neo (anchor)**, một ảnh **tích cực (positive)** và một ảnh **tiêu cực (negative)**, như được hiển thị trong Hình 7(b). Mạng Triplet cực tiểu hóa khoảng cách giữa các đặc trưng của ảnh neo và ảnh tích cực, đồng thời cực đại hóa khoảng cách giữa các đặc trưng của ảnh neo và ảnh tiêu cực.

*   Năm 2015, một **hàm mất mát xếp hạng bộ ba (triplet ranking loss)** được sử dụng trên đầu các đặc trưng CNN được chia sẻ để huấn luyện mạng cho việc tính toán các bộ mô tả nhị phân cho truy xuất ảnh [63].
*   Một **số hạng chính quy (regularization term)** dựa trên **tính nhất quán kề nhau (adjacency consistency)** được giới thiệu trong mạng Triplet để tăng cường khả năng phân biệt của mô tả đặc trưng CNN [64].
*   Zhuang et al. (2016) [130] đã sử dụng bộ ba để học mã băm bằng cách sử dụng **ma trận trọng số quan hệ (relation weights matrix)** và **tối ưu hóa cắt đồ thị (graph cuts optimization)**.
*   Hàm mất mát xếp hạng bộ ba, **ràng buộc trực giao (orthogonality constraint)** và hàm mất mát softmax được cực tiểu hóa **đồng thời (jointly)** trong [131].
*   Mạng Siamese dựa trên bộ ba cũng được sử dụng để truy xuất ảnh [132], [72].
*   Hàm mục tiêu dựa trên **lượng tử hóa bộ ba (triplet quantization)** cực tiểu hóa mất mát thông tin [135], [179].
*   Việc học đặc trưng dựa trên bộ ba cũng được khai thác cho truy xuất ảnh dựa trên phác thảo (sketch) [153].
*   Bộ ba cũng được khai thác cho **băm có giám sát (supervised hashing)** [99] và **băm không giám sát (unsupervised hashing)** [117], [123] cho truy xuất ảnh.

## D. Truy xuất dựa trên Mạng Đối sinh (GAN)

Mạng **Đối sinh (Generative Adversarial Network - GAN)** sử dụng hai mạng: **mạng sinh (generator)** và **mạng phân biệt (discriminator)**.

*   Mạng sinh tạo ra các mẫu mới trong tập huấn luyện từ một **vector ngẫu nhiên (random vector)**.
*   Trong khi đó, mạng phân biệt **phân biệt (distinguishes)** giữa hình ảnh được tạo ra và hình ảnh gốc.

*   Năm 2018, Song et al. đã giới thiệu **mạng đối sinh nhị phân (binary generative adversarial network - BGAN)** để tạo ra các mã nhị phân mang tính biểu diễn cho truy xuất ảnh [121].
*   Cùng thời điểm, một GAN có **chính quy (regularized)** được sử dụng để giới thiệu mô hình **BinGAN** [150] để học các **mẫu nhị phân nhỏ gọn (compact binary patterns)**. BinGAN sử dụng hai bộ chính quy, bao gồm một bộ chính quy **khớp khoảng cách (distance matching regularizer)** và một bộ chính quy **entropy biểu diễn nhị phân hóa (binarization representation entropy - BRE regularizer)**.
*   Năm 2018, các mạng sinh (generative networks) cũng được sử dụng trong [120] để phát triển **HashGAN** theo cách không giám sát nhằm tạo mã băm cho truy xuất ảnh.
*   Cùng thời điểm, một **HashGAN** khác được phát triển bằng cách sử dụng **Wasserstein GAN có điều kiện theo cặp (paired conditional Wasserstein GAN)** cho truy xuất ảnh [149].
*   GAN cũng đã được sử dụng cho:
    *   Truy xuất đa phương thức (cross-modal) [143], [145], [146], [160]
    *   Băm bán giám sát (semi-supervised hashing) [147], [161]
    *   Truy xuất ảnh dựa trên phác thảo (sketch) [148], [159], [163]
    *   Băm đối kháng không giám sát (unsupervised adversarial hashing) [122]
*   Năm 2020, **framework thống nhất BGAN+** dựa trên mạng đối sinh nhị phân [166] được phát triển cho truy xuất ảnh.

## E. Mạng Chú ý (Attention) cho Truy xuất Ảnh

**Cơ chế chú ý (Attention)** đã được quan sát thấy là một cách rất hiệu quả để mô hình hóa thông tin **nổi bật (saliency)** vào không gian đặc trưng nhằm tránh ảnh hưởng của **hậu cảnh (background)**.

*   Năm 2017, Noh et al. đã sử dụng các **điểm khóa (keypoints)** dựa trên cơ chế chú ý để chọn các **đặc trưng cục bộ sâu (deep local features)** quan trọng [55].
*   Yang et al. (2017) đã giới thiệu **CNN chú ý hai luồng (two-stream attentive CNNs)** bằng cách hợp nhất một CNN Chính (Main) và một CNN Phụ trợ (Auxiliary) - (MAC) cho truy xuất ảnh [138]. CNN chính tập trung vào các đặc trưng trực quan có tính phân biệt cho thông tin ngữ nghĩa, trong khi CNN phụ trợ tập trung vào một phần đặc trưng cho thông tin chú ý.
*   Tương tự, hai mạng con được sử dụng trong [155] cho **sự chú ý không gian (spatial attention)** và **đặc trưng toàn cục (global features)**, tương ứng.
*   Gần đây, Ng et al. [164] đã tính toán **mất mát độ tương tự bậc hai (second-order similarity - SOS loss)** trên các vùng được chọn dựa trên cơ chế chú ý của ảnh đầu vào cho truy xuất ảnh.
*   Các mô hình dựa trên cơ chế chú ý được phát triển cho:
    *   Truy xuất đa phương thức (cross-modal) [145]
    *   Truy xuất ảnh dựa trên phác thảo chi tiết (fine-grained sketch-based) [137]
*   **Băm sâu dựa trên mạng chú ý gradient (Gradient attention network based deep hashing)** [154] buộc các đặc trưng nhị phân CNN của một cặp phải cực tiểu hóa khoảng cách giữa chúng, bất kể dấu hoặc hướng của chúng.
*   Để **định vị (localize)** vùng ảnh quan trọng cho mô tả đặc trưng, một **mạng song tuyến không đồng nhất có chú ý (attentional heterogeneous bilinear network)** được sử dụng trong [180] để truy xuất ảnh thời trang (fashion).


## F. Mạng nơ-ron hồi quy cho việc truy xuất hình ảnh
Năm 2018, Lu và cộng sự đã sử dụng khái niệm mạng nơ-ron hồi quy
(RNN) để thực hiện băm nơ-ron hồi quy phân cấp (HRNH) nhằm tạo ra mã băm hiệu quả cho việc truy xuất hình ảnh [140]. Năm 2017, Shen và cộng sự đã sử dụng các mô-đun mạng tích chập dựa trên vùng với bộ nhớ dài hạn
(LSTM) cho việc truy xuất chéo văn bản-hình ảnh [139]. Bai và cộng sự (2019) cũng đã sử dụng mạng sâu hồi quy dựa trên LSTM trong khuôn khổ băm bộ ba để kế thừa tự nhiên thông tin hữu ích cho việc truy xuất hình ảnh [83].
G. Mạng học tăng cường dựa trên truy xuất
Năm 2018, Yuan và cộng sự đã khai thác học tăng cường cho việc truy xuất hình ảnh [77]. Họ đã sử dụng phương pháp không giãn thông qua gradient chính sách để tạo ra mã băm cho việc truy xuất hình ảnh. Việc bảo toàn tính tương đồng thông qua
mã nhị phân được tạo ra được sử dụng làm hàm thưởng. Năm 2020, Yang và cộng sự [167] đã sử dụng học tăng cường sâu
để thực hiện việc loại bỏ dư thừa trong các bit băm nhằm loại bỏ
các bit dư thừa và/hoặc có hại, giúp giảm thiểu sự mơ hồ
trong tính toán tính tương đồng cho việc truy xuất hình ảnh.
## H. Tóm tắt
Tóm tắt các phương pháp truy xuất ảnh dựa trên học sâu điều khiển mạng khác nhau như sau:
• Các đặc điểm của mạng nơ-ron tích chập được khai thác
cho mã băm và học mô tả bằng cách sử dụng
các ràng buộc khác nhau như lỗi phân loại, lỗi lượng tử hóa, bit độc lập, v.v.
• Để làm cho các đặc điểm đại diện hơn cho
ảnh, các mạng tự động mã hóa được sử dụng để thực thi
việc học dựa trên mất mát tái tạo.
• Khả năng phân biệt của mã băm mô tả được
nâng cao bằng cách khai thác mạng siamese và mạng ba.
Các ràng buộc khác nhau được sử dụng trên mã băm để làm cho nó có tính phân biệt và nhỏ gọn.
• Các phương pháp dựa trên mạng đối nghịch sinh sản
đã được sử dụng rộng rãi để cải thiện khả năng phân biệt và độ mạnh mẽ của các đặc điểm được học bởi mạng mã hóa
được hướng dẫn thông qua mạng phân biệt.
• Việc lựa chọn các đặc điểm quan trọng tự động được thực hiện
bằng cách sử dụng mô-đun chú ý để kiểm soát sự dư thừa trong
không gian đặc điểm. Mạng nơ-ron hồi quy và mạng học tăng cường cũng đã được chứng minh là rất hiệu quả trong việc truy xuất hình ảnh.